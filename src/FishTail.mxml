<?xml version="1.0" encoding="utf-8"?>
<!-- 07.14.15 - NE - Spun off as FishTail. -->

<!-- 06.19.12 - NE - Layered more info box so that it is always available to close when opened. -->
<!-- 06.18.12 - NE - Added custom legend title. Updated toggle behavior for NHD lakes and streams when viewing fish or habitat results. -->
<!-- 06.16.12 - NE - Added info in box linked for "?" in header. -->
<!-- 06.15.12 - NE - Added habitat model for habitat tab dropdown. Added NHD lakes/streams. -->
<!-- 06.14.12 - NE - Changed opacity for study area layer. Added tab navigator for scenario v. habitat viewing. -->
<!-- 06.13.12 - NE - Added fish sampling location and associated layer toggle. Added legend component for fish sample location. -->
<!-- 06.11.12 - NE - Added values to scenario dropdowns. Added tooltip to select a response dropdown. -->
<!-- 06.05.12 - NE - Added drop downs for scenario and results layer. -->
<!-- 06.01.12 - NE - Added more info linked through "?" in header. -->
<!-- 05.31.12 - NE - Set default for supplemental layers to off.  -->
<!-- 05.31.12 - NE - Added some supplemental layers and associated layer toggles. -->
<!-- 05.01.12 - NE - Begin as FishVis Mapper -->

<!-- 02.23.12 - NE - Updated to use resources and dynamic MapServiceLegend component in WiM library. -->
<!-- 02.23.12 - NE - Updated layer/legend box with newer LayerToggles and dynamic legend for layers. -->
<!-- 04.01.11 - JB - Added AS side logic for right-click and mousewheel -->
<!-- 03.14.11 - NE - Updated to include many WiM controls.  Base map selector, full screen button, collapsing search for geocoder, history. -->
<!-- 03.28.11 - JB - Template clean-up and updates -->
<!-- 12.13.10 - NE - Updated extent navigator location.  changed cursor to standard arrow. -->
<!-- 12.06.10 - JB - Updated Well-Known ID. -->
<!-- 07.28.10 - JB - updated geocode tag for 2.0 -->
<!-- 06.28.10 - JB - Added new Wim LayerLegend component -->
<!-- 05.25.10 - JB - Cleared FWS references from print template -->
<!-- 03.26.10 - JB - Initial template creation. -->
<mx:Application
	xmlns:mx="library://ns.adobe.com/flex/mx" 
	xmlns:fx="http://ns.adobe.com/mxml/2009" 
	xmlns:s="library://ns.adobe.com/flex/spark"
	xmlns:esri="http://www.esri.com/2008/ags"
	xmlns:wimControls="gov.usgs.wim.controls.*"
	xmlns:localControls="controls.*"
	xmlns:navigationClasses="com.esri.ags.controls.navigationClasses.*"
 	creationComplete="setup()"
    pageTitle="Fishtail Mapper" 
    layout="absolute" >
    
    <fx:Style source="assets/styles/main.css"/>
	<fx:Style source="assets/styles/infoSymbolBox.css"/>
	
	<fx:Script source="FishTail.as" />
	<fx:Script source="ScenarioModel.as" />
	<fx:Script source="HabitatModel.as" />
	
	<!--<fx:Style>
		@namespace esri "http://www.esri.com/2008/ags";
		esri|Navigation
		{
			skin-class: ClassReference("com.esri.ags.skins.NavigationHorizontalSkin");
		}
	</fx:Style> -->
    	
	<fx:Declarations>
		
		<esri:NavigationTool id="navToolbar" map="{map}"/>
		
		<esri:Locator id="locator"  outSpatialReference="{map.spatialReference}" url="http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"/>
				
		<esri:SimpleLineSymbol id="streamQuerySym" style="solid" color="0xFFFF00" width="2" />
		
		<esri:SimpleFillSymbol id="hucQuerySym" style="null" color="0x000000" alpha="0.25">
			<esri:outline>
				<esri:SimpleLineSymbol style="solid" color="0xFFFF00" width="2" />
			</esri:outline>
		</esri:SimpleFillSymbol> 
		
		<fx:Array id="iconArray">             
			<fx:Object icon="{grayCanvasIcon}">
				<fx:toolTip>Gray basemap</fx:toolTip>
			</fx:Object>  
			<fx:Object icon="{satelliteIcon}">
				<fx:toolTip>Imagery/Labels</fx:toolTip>
			</fx:Object>
			<fx:Object icon="{mountainIcon}">
				<fx:toolTip>Topo</fx:toolTip>
			</fx:Object>
			<fx:Object icon="{streetsIcon}">
				<fx:toolTip>Streets</fx:toolTip>
			</fx:Object>
		</fx:Array>
		
		<s:RadioButtonGroup id="streamTempOpt" />
		
		<s:RadioButtonGroup id="displayByOpt" />
		
		<s:RadioButtonGroup id="ecoRegionOpt" />
		
		<s:RadioButtonGroup id="streamOpt" />
		
		<s:RadioButtonGroup id="topicOpt" />
		<s:RadioButtonGroup id="timeOpt" />
	    	    
	    <!-- Info Box Symbol for displaying layer query results -->
		
		<esri:InfoSymbol id="singleGraphicSym" containerStyleName="queryInfoBox" >
	   		<esri:infoRenderer>
	   			<fx:Component>
	   				<mx:VBox styleName="infoBox" width="100%" >		   				
		   				<fx:Style source="assets/styles/infoSymbolBox.css"/>
	   					<fx:Script>
	   						<![CDATA[
	   							import mx.controls.Alert;
    							
    							private function infoClear():void
	   							{
	   								parent.parent.visible = false;
	   							}
	   							
	   						]]>
	   					</fx:Script>
	   					<mx:HBox width="100%">
		   					<mx:Label text="{data.title}" color="white" fontWeight="bold" fontSize="12" />
	   						<mx:HBox width="100%" horizontalGap="0" />
				   			<mx:Button id="closeButton" styleName="InfoCloseButton" height="18" width="18" click="infoClear()"/>
			   			</mx:HBox>
			   			<mx:VBox styleName="poiContain" width="100%" paddingTop="10" paddingBottom="5" paddingLeft="5" paddingRight="5" verticalGap="0">
			   				<mx:HBox horizontalGap="0">
				   				<mx:Text text="" fontWeight="bold" />
				   				<mx:Text text="{data.value}" />
			   				</mx:HBox>
			   			</mx:VBox>
				   	</mx:VBox>
				</fx:Component>
	   		</esri:infoRenderer>
		</esri:InfoSymbol>

		<!-- End Info Box Symbol -->
		
		<!-- search expand collapse animation -->
		<!--<s:Parallel id="scaleSequence" 
					targets="{[late20ExContent]}" 
					duration="1000" >
			<s:children>
				<mx:AnimateProperty id="scaleYAnimation" property="scaleY" />
				<s:Parallel id="imgSequence" target="{late20Ex}">
					<s:children>
						<mx:AnimateProperty id="imgRotateAnimation" property="rotation" />
					</s:children>
				</s:Parallel>
			</s:children>
		</s:Parallel>-->
		
		<!--USGS HeaderFooter Link Box -->
		<s:BorderContainer 
			id="headerFooterLinkBox" 
			backgroundColor="white" 
			cornerRadius="5" 
			mouseOut="popUp_mouseOutHandler(event, 'headerFooterLinkBox')"
			height="100%"
			>						
			
			<s:VGroup width="100%">
				
				<mx:HBox backgroundColor="black" textAlign="center" cornerRadius="5" width="100%" paddingTop="5" paddingLeft="5" paddingBottom="5" paddingRight="5">
					<mx:Text width="100%" color="white" fontSize="14" fontWeight="bold" text="{resourceManager.getString('ui.text', 'headerFooterLinks')}" />
				</mx:HBox>
				
				<mx:VBox width="275" height="100%">
					
					<mx:Text width="100%" height="25" color="blue" textDecoration="underline" textAlign="left" condenseWhite="true" paddingTop="5" paddingLeft="5" paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="http://www.greatlakeslcc.org/">Upper Midwest & Great Lakes Landscape Conservation Cooperative</a></p><br />				
							]]>
						</mx:htmlText>
					</mx:Text>
					<!--<mx:Text width="100%" height="25" color="blue" textDecoration="underline" textAlign="left" condenseWhite="true" paddingLeft="5"  paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="http://www.usgs.gov/ask/">Contact USGS</a></p><br />			
							]]>
						</mx:htmlText>
					</mx:Text>
					<mx:Text width="100%" height="25" color="blue" textDecoration="underline" textAlign="left" condenseWhite="true" paddingLeft="5" paddingBottom="5" paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="http://search.usgs.gov/">Search USGS</a></p><br />						
							]]>
						</mx:htmlText>
					</mx:Text>
					<mx:Text width="100%" height="25" color="blue" textDecoration="underline" textAlign="left" condenseWhite="true" paddingLeft="5" paddingBottom="5" paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="http://www.usgs.gov/laws/accessibility.html">Accessibility</a></p><br />						
							]]>
						</mx:htmlText>
					</mx:Text>
					<mx:Text width="100%" height="25" color="blue" textDecoration="underline" textAlign="left" condenseWhite="true" paddingLeft="5" paddingBottom="5" paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="http://www.usgs.gov/foia/">FOIA</a></p><br />						
							]]>
						</mx:htmlText>
					</mx:Text>
					<mx:Text width="100%" height="25" color="blue" textDecoration="underline" textAlign="left" condenseWhite="true" paddingLeft="5" paddingBottom="5" paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="http://www.usgs.gov/laws/privacy.html">Privacy</a></p><br />						
							]]>
						</mx:htmlText>
					</mx:Text>
					<mx:Text width="100%" height="25" color="blue" textDecoration="underline" textAlign="left" condenseWhite="true" paddingLeft="5" paddingBottom="5" paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="http://www.usgs.gov/laws/policies_notices.html">Policies and Notices</a></p><br />						
							]]>
						</mx:htmlText>
					</mx:Text>-->					
				</mx:VBox>
			</s:VGroup>			
			
		</s:BorderContainer>
		<!--End USGS HeaderFooter Link Box-->
		
		<!-- FishTail Link Box -->
		<s:BorderContainer 
			id="FishTailLinkBox" 
			backgroundColor="white" 
			cornerRadius="5" 
			mouseOut="popUp_mouseOutHandler(event, 'FishTailLinkBox')"
			height="100%">						
			
			<s:VGroup width="100%">
				
				<mx:HBox backgroundColor="black" textAlign="center" cornerRadius="5" width="100%" paddingTop="5" paddingLeft="5" paddingBottom="5" paddingRight="5">
					<mx:Text width="100%" color="white" fontSize="14" fontWeight="bold" text="Project Links" />
				</mx:HBox>
				
				<mx:VBox width="100%" height="100%">
					
					<mx:Text width="100%" height="25" color="blue" useHandCursor="true" buttonMode="true" mouseChildren="false" textDecoration="underline" textAlign="left" condenseWhite="true" paddingTop="5" paddingLeft="5" paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="">Project overview and explanation</a></p><br />				
							]]>
						</mx:htmlText>
					</mx:Text>
					<mx:Text width="100%" height="25" color="blue" useHandCursor="true" buttonMode="true" mouseChildren="false" textDecoration="underline" textAlign="left" condenseWhite="true" paddingLeft="5"  paddingRight="5">
						<mx:htmlText>
							<![CDATA[						
							<p><a target="_blank" href="">Mapping tool user guide</a></p><br />			
							]]>
						</mx:htmlText>
					</mx:Text>				
				</mx:VBox>
			</s:VGroup>			
			
		</s:BorderContainer>
		<!--End FishTail Link Box-->

	</fx:Declarations>
	
	
	<!-- Main Map -->
	
	<mx:Canvas id="mapContainer" width="100%" height="100%">
		
	    <esri:Map id="map" styleName="mapStyle" openHandCursorVisible="false" logoVisible="false" navigationClass="gov.usgs.wim.controls.WiMNavigation" mapClick="onMapClick(event)" load="mapLoad()" extentChange="onExtentChange(event)">
	    	<esri:extent>            
				<esri:Extent id="init" xmin="-11682660.549430344" ymin="4217956.6748205405" xmax="-6986369.531590365" ymax="6884080.22140678">                
					<esri:SpatialReference wkid="102100"/>            
				</esri:Extent>
			</esri:extent>
			<esri:ArcGISTiledMapServiceLayer            
				visible="{baseLayers.selectedLayer == 'Streets'}"     
				show="baseSwitch(event)"    
				url="http://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer" />
			<esri:ArcGISTiledMapServiceLayer            
				visible="{baseLayers.selectedLayer == 'Imagery/Labels'}"            
				show="baseSwitch(event)"     
				url="http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer" />
			<esri:ArcGISTiledMapServiceLayer            
				visible="{baseLayers.selectedLayer == 'Imagery/Labels'}"            
				show="baseSwitch(event)"       
				url="http://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer" />
			<esri:ArcGISTiledMapServiceLayer            
				visible="{baseLayers.selectedLayer == 'Topo'}"            
				show="baseSwitch(event)"      
				url="http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer" />
			<esri:ArcGISTiledMapServiceLayer            
				visible="{baseLayers.selectedLayer == 'Gray' || baseLayers.selectedLayer == 'NPS'}"            
				show="baseSwitch(event)"      
				url="http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer" />
			<esri:ArcGISTiledMapServiceLayer            
				visible="{baseLayers.selectedLayer == 'Gray' || baseLayers.selectedLayer == 'NPS'}"            
				show="baseSwitch(event)"      
				url="http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer" />
			<esri:ArcGISTiledMapServiceLayer            
				visible="{baseLayers.selectedLayer == 'The National Map'}"            
				show="baseSwitch(event)"      
				url="http://basemap.nationalmap.gov/ArcGIS/rest/services/USGSTopo/MapServer" />
			<esri:WebTiledLayer
				visible="{baseLayers.selectedLayer == 'NPS'}"     
				copyright="National Park Service"
				subDomains="{ABCD}"
				urlTemplate="{npsUrlTemplate}" />
			
			<!-- Begin FISH VIS model mapper layers -->
			<esri:ArcGISDynamicMapServiceLayer
				id="nhdLakes"
				visible="{nhdLakesToggle.selected}" 
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(nhdLakes)"
				alpha="1"
				url="{resourceManager.getString('urls', 'supplementalLayersUrl')}" >
				<esri:visibleLayers>                
					<mx:ArrayCollection>                    
						<fx:Number>4</fx:Number> 
					</mx:ArrayCollection>            
				</esri:visibleLayers>
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="streamBuffer"
				visible="{streamBufferToggle.selected}" 
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(streamBuffer)"
				alpha="1"
				url="{resourceManager.getString('urls', 'supplementalLayersUrl')}" >
				<esri:visibleLayers>                
					<mx:ArrayCollection>                    
						<fx:Number>5</fx:Number> 
					</mx:ArrayCollection>            
				</esri:visibleLayers>
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISTiledMapServiceLayer
				id="streamBuffersCache"
				visible="{streamBufferToggle.selected}"
				alpha="{streamBuffer.alpha}" 
				url="{resourceManager.getString('urls', 'streamBuffersCache')}" >
			</esri:ArcGISTiledMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="nhdStreams"
				visible="{nhdStreamsToggle.selected}"
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(nhdStreams)"
				alpha="1" 
				url="{resourceManager.getString('urls', 'supplementalLayersUrl')}" >
				<esri:visibleLayers>                
					<mx:ArrayCollection>                    
						<fx:Number>3</fx:Number>
					</mx:ArrayCollection>            
				</esri:visibleLayers>
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISTiledMapServiceLayer
				id="nhdStreamsCache"
				visible="{nhdStreamsToggle.selected}"
				alpha="{nhdStreams.alpha}" 
				url="{resourceManager.getString('urls', 'streamsCache')}" >
			</esri:ArcGISTiledMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="catchments"
				visible="{catchmentsToggle.selected}" 
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(catchments)"
				alpha="1"
				url="{resourceManager.getString('urls', 'supplementalLayersUrl')}" >
				<esri:visibleLayers>                
					<mx:ArrayCollection>                    
						<fx:Number>0</fx:Number>  
					</mx:ArrayCollection>            
				</esri:visibleLayers>
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISTiledMapServiceLayer
				id="nhdCatchmentsCache"
				visible="{catchmentsToggle.selected}"
				alpha="{catchments.alpha}" 
				url="{resourceManager.getString('urls', 'catchmentsCache')}" >
			</esri:ArcGISTiledMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="huc12s"
				visible="{huc12Toggle.selected}" 
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(huc12s)"
				alpha="0.65"
				url="{resourceManager.getString('urls', 'supplementalLayersUrl')}" >
				<esri:visibleLayers>                
					<mx:ArrayCollection>                    
						<fx:Number>1</fx:Number>  
					</mx:ArrayCollection>            
				</esri:visibleLayers>
			</esri:ArcGISDynamicMapServiceLayer>
			
				<!-- Begin supplemental layers -->
				<esri:ArcGISDynamicMapServiceLayer
					id="padus"
					visible="{padusToggle.selected}"
					updateStart="loadingScreenEnable()"
					updateEnd="layerUpdateComp(padus)"
					alpha="0.65"
					url="{resourceManager.getString('urls', 'padusUrl')}" >
					<esri:visibleLayers>
						<s:ArrayCollection>
							<fx:Number>0</fx:Number>
						</s:ArrayCollection>
					</esri:visibleLayers>
				</esri:ArcGISDynamicMapServiceLayer>
				<esri:ArcGISDynamicMapServiceLayer
					id="padusStatus"
					visible="{padusStatusToggle.selected}"
					updateStart="loadingScreenEnable()"
					updateEnd="layerUpdateComp(padus)"
					alpha="0.65"
					url="{resourceManager.getString('urls', 'padusStatusUrl')}" >
					<esri:visibleLayers>
						<s:ArrayCollection>
							<fx:Number>0</fx:Number>
						</s:ArrayCollection>
					</esri:visibleLayers>
				</esri:ArcGISDynamicMapServiceLayer>
				<esri:ArcGISDynamicMapServiceLayer
					id="landCover2006"
					visible="{landCoverToggle.selected}"
					updateStart="loadingScreenEnable()"
					updateEnd="layerUpdateComp(landCover2006)"
					alpha="0.65"
					url="{resourceManager.getString('urls', 'landCover2006Url')}" >
					<esri:visibleLayers>
						<s:ArrayCollection>
							<fx:Number>0</fx:Number>
						</s:ArrayCollection>
					</esri:visibleLayers>
				</esri:ArcGISDynamicMapServiceLayer>
				<esri:ArcGISDynamicMapServiceLayer
					id="disturbance"
					visible="{disturbanceToggle.selected}"
					updateStart="loadingScreenEnable()"
					updateEnd="layerUpdateComp(disturbance)"
					alpha="0.65"
					url="{resourceManager.getString('urls', 'disturbanceUrl')}" >
					<esri:visibleLayers>
						<s:ArrayCollection>
							<fx:Number>3</fx:Number>
						</s:ArrayCollection>
					</esri:visibleLayers>
				</esri:ArcGISDynamicMapServiceLayer>
				<esri:ArcGISDynamicMapServiceLayer
					id="ecoregions"
					visible="{ecoregionsToggle.selected}"
					updateStart="loadingScreenEnable()"
					updateEnd="layerUpdateComp(ecoregions)"
					alpha="0.65"
					url="{resourceManager.getString('urls', 'supplementalLayersUrl')}" >
					<esri:visibleLayers>
						<s:ArrayCollection>
							<fx:Number>7</fx:Number>
						</s:ArrayCollection>
					</esri:visibleLayers>
				</esri:ArcGISDynamicMapServiceLayer>
				<esri:ArcGISDynamicMapServiceLayer
					id="lcc"
					visible="{lccToggle.selected}"
					updateStart="loadingScreenEnable()"
					updateEnd="layerUpdateComp(lcc)"
					alpha="0.65"
					url="{resourceManager.getString('urls', 'lccUrl')}" >
					<esri:visibleLayers>
						<s:ArrayCollection>
							<fx:Number>0</fx:Number>
						</s:ArrayCollection>
					</esri:visibleLayers>
				</esri:ArcGISDynamicMapServiceLayer>
				<!-- End supplemental layers -->
			
			<!--<esri:ArcGISDynamicMapServiceLayer
				id="streamTemp"
				visible="{resultsTabs.selectedIndex == 1 &amp;&amp; (streamTempToggle != null) ? streamTempToggle.selected == true : false}"
				alpha="1" 
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(streamTemp)"
				url="{resourceManager.getString('urls', 'streamTempUrl')}" >
			</esri:ArcGISDynamicMapServiceLayer>-->
			<esri:ArcGISDynamicMapServiceLayer
				id="scenariosHUC12"
				visible="{resultsTabs.selectedIndex == 0 &amp;&amp; huc12.selected == true}"
				alpha="0.7" 
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(scenariosHUC12)"
				url="{resourceManager.getString('urls', 'scenariosHUC12Url')}" >
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="climateStreamflow"
				visible="false" 
				alpha="0.7"
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(climateStreamflow)"
				url="{resourceManager.getString('urls', 'climateStreamflow')}" > <!--visible="{resultsTabs.selectedIndex == 0 &amp;&amp; (climateProj.selected || streamflow.selected) &amp;&amp; map.scale &lt; 1500000}"-->
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="climateStreamflowSmall"
				visible="false"
				alpha="0.7"
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(climateStreamflowSmall)"
				url="{resourceManager.getString('urls', 'climateStreamflowSmall')}" > <!--visible="{resultsTabs.selectedIndex == 0 &amp;&amp; (climateProj.selected || streamflow.selected) &amp;&amp; map.scale &gt; 1500000}"-->
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="scenariosCatchments"
				visible="false" 
				alpha="0.7" 
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(scenariosCatchments)"
				url="{resourceManager.getString('urls', 'scenariosCatchmentsUrl')}" > <!-- visible="{resultsTabs.selectedIndex == 0 &amp;&amp; catchment.selected == true &amp;&amp; streamflow.selected == false &amp;&amp; climateProj.selected == false}" -->
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="scenariosCatchmentsSmall"
				visible="false"
				alpha="0.7"  
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(scenariosCatchmentsSmall)"
				url="{resourceManager.getString('urls', 'scenariosCatchmentsSmallUrl')}" > <!-- visible="{(resultsTabs.selectedIndex == 0 &amp;&amp; streamReach.selected == true &amp;&amp; streamflow.selected == false &amp;&amp; climateProj.selected == false) &amp;&amp; map.scale &gt; 1500000}" -->
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="scenarios"
				visible="false"
				alpha="1" 
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(scenarios)"
				url="{resourceManager.getString('urls', 'scenariosUrl')}" > <!-- visible="{(resultsTabs.selectedIndex == 0 &amp;&amp; streamReach.selected == true &amp;&amp; streamflow.selected == false &amp;&amp; climateProj.selected == false) &amp;&amp; map.scale &lt; 1500000}" -->
			</esri:ArcGISDynamicMapServiceLayer>
			<esri:ArcGISDynamicMapServiceLayer
				id="scenariosSmall"
				visible="false"
				alpha="1"  
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(scenariosSmall)"
				url="{resourceManager.getString('urls', 'scenariosSmallUrl')}" > <!-- visible="{(resultsTabs.selectedIndex == 0 &amp;&amp; streamReach.selected == true &amp;&amp; streamflow.selected == false &amp;&amp; climateProj.selected == false) &amp;&amp; map.scale &gt; 1500000}" -->
			</esri:ArcGISDynamicMapServiceLayer>
			<!--<esri:ArcGISDynamicMapServiceLayer
				id="fishVisSearch"
				visible="{resultsTabs.selectedIndex == 1}"
				alpha="1"
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(fishVisSearch)"
				url="{resourceManager.getString('urls', 'fishVisSearch')}" >
				<esri:visibleLayers>
					<s:ArrayCollection>
						<fx:Number>-1</fx:Number>
					</s:ArrayCollection>
				</esri:visibleLayers>
			</esri:ArcGISDynamicMapServiceLayer>-->
			<esri:ArcGISDynamicMapServiceLayer
				id="fishSampleLocations"
				visible="{fishSampleLocationsToggle.selected}"
				updateStart="loadingScreenEnable()"
				updateEnd="layerUpdateComp(fishSampleLocations)"
				alpha="1"
				url="{resourceManager.getString('urls', 'supplementalLayersUrl')}" >
				<esri:visibleLayers>                
					<s:ArrayCollection>                    
						<fx:Number>2</fx:Number>
					</s:ArrayCollection>            
				</esri:visibleLayers>
			</esri:ArcGISDynamicMapServiceLayer>
				
			<!-- End FISH VIS model mapper layers -->
			
			<esri:GraphicsLayer id="queryGraphicsLayer" />
	  		<esri:GraphicsLayer id="infoGraphicsLayer" />
	  	</esri:Map>
		
		<localControls:BasicLoadingScreen id="mapLoadingScreen" gifUrl="assets/images/ajax-loader.gif" useGif="true" loadingScreenText="...Loading..." color="0xFFFFFF" 
										  height="100" 
										  width="350" 
										  top="{(map.height/2) - (mapLoadingScreen.height/2)}" 
										  left="{(map.width/2) - (mapLoadingScreen.width/2)}" 
										  alpha="0.9" />
		
		<localControls:BasicLoadingScreen id="exportCSVLoadingScreen" visible="false" gifUrl="assets/images/ajax-loader.gif" useGif="true" loadingScreenText="...Exporting CSV data for search results..." color="0xFFFFFF" 
										  height="100" 
										  width="350" 
										  top="{(map.height/2) - (exportCSVLoadingScreen.height/2)}" 
										  left="{(map.width/2) - (exportCSVLoadingScreen.width/2)}" 
										  alpha="0.9" />
		
	</mx:Canvas>
  
  	
  	<!-- End Main Map -->
  	
  	
  	<!-- Header --> 
  	
  	<mx:Canvas>
		<mx:HBox id="header" color="white" backgroundColor="black" borderStyle="solid" borderColor="black" cornerRadius="5" top="5" left="5" paddingTop="5" paddingBottom="5" paddingLeft="5" paddingRight="5"> 
			<mx:Image id="headerLogo" source="{resourceManager.getString('ui.graphics', 'headerLogo')}" useHandCursor="true" buttonMode="true" mouseChildren="false" toolTip="{resourceManager.getString('ui.text', 'headerFooterLinks')}" click="showUSGSPopUpBox(event, 'headerFooterLinkBox')"/>
			<mx:HBox backgroundColor="black" width="100%" paddingLeft="5" paddingRight="10" paddingTop="5" verticalGap="0" fontFamily="Arial" >
				<mx:Label text="{resourceManager.getString('ui.text', 'headerTitle')}" color="0x3f70b6" fontSize="28"/>
				<mx:Label text="{resourceManager.getString('ui.text', 'headerSubTitle')}" fontWeight="bold" color="white" fontSize="28" 
						  buttonMode="true" click="navigateToURL(new URLRequest(FlexGlobals.topLevelApplication.url), '_self')"/>
				<mx:Label text="beta" color="gray" fontSize="20"/>
			</mx:HBox>
			<s:VGroup paddingTop="10" paddingRight="10" id="moreInfoIcon">
				<s:BorderContainer
					id="moreInfoButton"
					backgroundColor="0x990033"
					cornerRadius="5"
					height="35"
					borderColor="1"
					right="0"
					toolTip="Click for more information about FishVis" 
					click="moreInfo.visible = true;">
					<s:HGroup height="100%" paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5" fontWeight="bold" verticalAlign="middle">
						<s:Label text="About" fontSize="14" color="white" />
					</s:HGroup>
				</s:BorderContainer>
			</s:VGroup>
		</mx:HBox>
	</mx:Canvas>
	
	<!-- End Header --> 
	
	
	
	
	<!-- Controls -->
	
	<wimControls:FullScreenButton top="5" right="5" />
	
	<wimControls:ExtentNavigator targetMap="{map}" mini="true" fullExtent="{init}" targetNavigation="{navToolbar}" id="navigation" styleName="controlBox" top="80" left="5" />
	
	<wimControls:CollapsingSearch id="geocoder" 
							   styleName="controlBoxTrans" 
							   top="45" 
							   right="5" 
							   width="260"
							   searchHint="{resourceManager.getString('ui.text', 'geocodeSearchHintText')}"
							   searchButtonText="{resourceManager.getString('ui.text', 'geocodeSearchButtonText')}"
							   searchFunction="{geoCode}" />
	
	<!-- End Controls -->
	
	<!-- Custom data tools -->
	<wimControls:CollapsingBox id="controlLayers" 
					   top="85" 
					   right="5"	
					   startCollapsed="false"	
					   boxTitle="Explore FishTail"
					   height="{FlexGlobals.topLevelApplication.height-200}">
		<wimControls:contentGroup>
			<s:VGroup>
				<s:VGroup
					width="380">
					<mx:TabNavigator id="resultsTabs" width="380" height="100%" minHeight="500" backgroundColor="black">
						<mx:Box id="modelResults" label="Browse responses" color="white">
							<s:Group width="100%" bottom="20">
								<s:Rect width="100%" height="100%">
									<s:fill><s:SolidColor color="black" /></s:fill>
								</s:Rect>
								<s:VGroup paddingTop="5" paddingLeft="5" paddingBottom="10">
									<!--<s:HGroup>
										<s:Label color="white" text="Step 1: " fontWeight="bold"/><s:Label text="Limit results to..." />
									</s:HGroup>
									<s:HGroup paddingLeft="25" paddingBottom="10">
										<s:DropDownList id="dataLimit" color="black" prompt="Watershed" >
											<s:ArrayCollection>
												<fx:String>Watershed</fx:String>
											</s:ArrayCollection>
										</s:DropDownList>
										<s:TextInput color="black" text="entire Great Lakes basin" width="150" />
									</s:HGroup>-->
									<s:HGroup color="0xFFFF99" fontWeight="bold">
										<s:Label text="Step 1: " /><s:Label text="Display by..." />
									</s:HGroup>
									<s:VGroup paddingLeft="25" gap="0" paddingBottom="10">
										<s:HGroup verticalAlign="middle">
											<s:RadioButton group="{displayByOpt}"
													   id="huc12"
													   label="HUC 12" 
													   value="CS"/>
											<mx:Image source="./assets/images/help_tip.png" toolTip="HUC 12 - Drainage basins in the United States are divided and sub-divided into successively smaller hydrologic units (HUC), as defined by the USGS Watershed Boundary Dataset. A HUC12 refers to the sixth-level HUC with a 12-digit identification code." />
										</s:HGroup>
										<s:HGroup verticalAlign="middle">
											<s:RadioButton group="{displayByOpt}"
													   id="catchment"
													   selected="true"
													   label="Catchment" 
													   value="CS" />
											<mx:Image source="./assets/images/help_tip.png" toolTip="The area of a landscape that collects precipitation and drains to a stream through surface runoff, shallow groundwater delivery, and the stream’s upstream tributaries.  Catchment boundaries are determined by the topography of the landscape.." />
										</s:HGroup>
										<s:HGroup verticalAlign="middle">
											<s:RadioButton group="{displayByOpt}"
													   id="streamReach"
													   label="Stream reach" 
													   value="CS" />
											<mx:Image source="./assets/images/help_tip.png" toolTip="A segment of stream that extend from confluence to confluence or to junctions with lakes or reservoirs. In headwater streams, the origin of streams serves as the beginning of reaches that end at their first confluence or junction with a lake or reservoir. This network of confluence to confluence reaches extends to the mouths of rivers for the entire study region." />
										</s:HGroup>
									</s:VGroup>
									<s:HGroup color="0xFFFF99" fontWeight="bold">
										<s:Label text="Step 2: "/><s:Label text="Select Ecoregion" />
										<mx:Image source="./assets/images/help_tip.png" toolTip="US Environmental Protection Agency’s (EPA) Wadeable Streams Assessment (WSA) ecoregions are aggregations of Omernik level III terrestrial ecoregions (Omernik 1987) and are defined as large regions of the landscape with broadly similar landform and climate characteristics (https://www.epa.gov/national-aquatic-resource-surveys/wadeable-streams-assessment)." />
									</s:HGroup>
									<s:VGroup paddingLeft="25" gap="0" paddingBottom="10">
										<s:CheckBox id="northAppEco"
													   label="Northern Appalachians" 
													   selected="true" />
										<s:CheckBox id="southAppCoastEco" 
													   label="Southern Appalachians and Coastal Plains" />
										<s:CheckBox id="tempPlainsEco" 
													   label="Temperate Plains" />
										<s:CheckBox id="upperMidEco" 
													   label="Upper Midwest" />
									</s:VGroup>
									<s:HGroup color="0xFFFF99" fontWeight="bold">
										<s:Label text="Step 3: "/><s:Label text="Select Stream Size" />
									</s:HGroup>
									<s:VGroup paddingLeft="25" gap="0" paddingBottom="10">
										<s:HGroup verticalAlign="middle">
											<s:CheckBox id="creek"
													   label="Creek" 
													   selected="true" />
											<mx:Image source="./assets/images/help_tip.png" toolTip="A stream reach with a network catchment area less than 100 square kilometers" />
										</s:HGroup>
										<s:HGroup verticalAlign="middle">
											<s:CheckBox id="river" 
													   label="River" />
											<mx:Image source="./assets/images/help_tip.png" toolTip="A stream reach with a network catchment area greater than 100 square kilometers." />
										</s:HGroup>
									</s:VGroup>
									<s:HGroup color="0xFFFF99" fontWeight="bold">
										<s:Label text="Step 4: "/><s:Label text="Select Habitat Response Index" />
									</s:HGroup>
									<s:VGroup paddingLeft="25" gap="0" paddingBottom="10">
										<s:HGroup verticalAlign="middle">
											<s:RadioButton group="{topicOpt}"
													   id="landuse"
													   label="Land use" 
													   selected="true"
													   value="LU" />
											<mx:Image source="./assets/images/help_tip.png" toolTip="Streams are scored based on fish species responses to the amounts of human land use in the forms of urban, agricultural, and impervious surface land cover in the catchment. Fish species responses to land use were determined by a dual threshold detection method. The percentage of each human land uses was calculated from the 2006 National Land Cover Database (NLCD 2006)." />
										</s:HGroup>
										<s:VGroup paddingLeft="25" gap="0">
											<s:DropDownList id="landUseSelect" visible="{landuse.selected}" includeInLayout="{landUseSelect.visible}" labelField="text" color="black" prompt="Select a response..." width="200" >
												<s:ArrayCollection>
													<fx:Object text="Cumulative" value="AS"></fx:Object>
													<fx:Object text="Local buffer" value="LB"></fx:Object>
													<fx:Object text="Local catchment" value="LC"></fx:Object>
													<fx:Object text="Network buffer" value="NB"></fx:Object>
													<fx:Object text="Network catchment" value="NC"></fx:Object>
												</s:ArrayCollection>
											</s:DropDownList>
										</s:VGroup>
										<s:HGroup verticalAlign="middle">
											<s:RadioButton group="{topicOpt}"
													   id="fragmentation" 
													   label="Fragmentation" 
													   value="FR" />
											<mx:Image source="./assets/images/help_tip.png" toolTip="Streams are scored based on fish species responses to stream network fragmentation in the forms of both large dams and road crossings. Fish species responses to fragmentation were determined by dual threshold detection.  Fragmentation variables were developed from the National Anthropogenic Barriers Dataset (NABD 2012) and TIGER US roads (2006)." />
										</s:HGroup>
										<s:HGroup verticalAlign="middle" visible="{huc12.selected == false}" includeInLayout="{huc12.selected == false}">
											<s:RadioButton group="{topicOpt}"
												   id="waterqualimp" 
												   label="Water-quality impairment" 
												   value="QW" click="waterqualimp_clickHandler(event)" />
											<mx:Image source="./assets/images/help_tip.png" toolTip="Streams are scored based on the presence of 303(d) impairments weighted based on the impact of impairments effects on the fish community. Impairment data is drawn from 2002 Impaired Waters Baseline NHDPlus Indexed Dataset, which identifies water bodies that do not meet a state’s defined requirements related to chemical, physical and biological requirements for clean water as part of the Clean Water Act (EPA, 2010). Attention: Please note that these scores should not be used to compare across states, as scores were created on a state by state basis due to differences in sampling protocol and listing thresholds." />
										</s:HGroup>
										<s:VGroup paddingLeft="25" gap="0" visible="{huc12.selected == false}" includeInLayout="{huc12.selected == false}">
											<s:DropDownList id="stateSelect" visible="{waterqualimp.selected}" includeInLayout="{stateSelect.visible}" labelField="text" color="black" prompt="Select a state..." width="200" >
												<s:ArrayCollection>
													<fx:Object text="Connecticut" value="CT"></fx:Object>
													<fx:Object text="Delaware" value="DE"></fx:Object>
													<fx:Object text="Illinois" value="IL"></fx:Object>
													<fx:Object text="Indiana" value="IN"></fx:Object>
													<fx:Object text="Iowa" value="IA"></fx:Object>
													<fx:Object text="Kentucky" value="KY"></fx:Object>
													<fx:Object text="Ohio" value="OH"></fx:Object>
													<fx:Object text="Maine" value="ME"></fx:Object>
													<fx:Object text="Maryland" value="MD"></fx:Object>
													<fx:Object text="Massachusetts" value="MA"></fx:Object>
													<fx:Object text="Michigan" value="MI"></fx:Object>
													<fx:Object text="Minnesota" value="MN"></fx:Object>
													<fx:Object text="Missouri" value="MO"></fx:Object>
													<fx:Object text="New Hampshire" value="NH"></fx:Object>
													<fx:Object text="New Jersey" value="NJ"></fx:Object>
													<fx:Object text="New York" value="NY"></fx:Object>
													<fx:Object text="Pennsylvania" value="PA"></fx:Object>
													<fx:Object text="Rhode Island" value="RI"></fx:Object>
													<fx:Object text="Vermont" value="VT"></fx:Object>
													<fx:Object text="Virginia" value="VA"></fx:Object>
													<fx:Object text="West Virginia" value="WV"></fx:Object>
													<fx:Object text="Wisconsin" value="WI"></fx:Object>
												</s:ArrayCollection>
											</s:DropDownList>
										</s:VGroup>
										<s:HGroup verticalAlign="middle">
											<s:RadioButton group="{topicOpt}"
														   id="futureclimate" 
														   label="Future climate"
														   value="CL" />
											<mx:Image source="./assets/images/help_tip.png" toolTip="Streams are scored based on the risk of change to the fish community due to changes in climate. Risk of change determined based on the number of climate models for which a stream segment exhibits a change in fish community class between current and future climate conditions (Vimont, 2005)." />
										</s:HGroup>
										<!--<s:VGroup paddingLeft="25" gap="0" paddingBottom="10" visible="{futureclimate.selected}" includeInLayout="{futureclimate.selected}">
											<s:DropDownList id="emissionScenario" color="black" width="240" visible="{futureclimate.selected}" includeInLayout="{futureclimate.selected}" prompt="emission scenario" >
												<s:ArrayCollection>
													<fx:String>scenario one</fx:String>
													<fx:String>scenario two</fx:String>
												</s:ArrayCollection>
											</s:DropDownList>
											<s:DropDownList id="GCM" color="black" width="240" visible="{futureclimate.selected}" includeInLayout="{futureclimate.selected}" prompt="GCM" >
												<s:ArrayCollection>
													<fx:String>GCM one</fx:String>
													<fx:String>GCM two</fx:String>
												</s:ArrayCollection>
											</s:DropDownList>
										</s:VGroup>-->
									</s:VGroup>
									
									
									<!-- move this to outside of choices to keep it anchored to right side of the larger box -->
									<s:HGroup right="10" horizontalAlign="right" width="100%" paddingTop="0" paddingBottom="0">
										<s:Button label="Clear" click="scenarioClear()" height="30" color="black" />
										<s:Button label="Go" click="{scenarioUpdate('go')}" height="30" chromeColor="0x3f70b6" color="black" fontWeight="bold" fontSize="11" />
									</s:HGroup>
									
									<!--<s:Label id="browseWarning" color="0xFF0000" width="290" paddingTop="20" paddingLeft="10" visible="false" includeInLayout="{browseWarning.visible}" text="You have not entered enough information to display a map. Check your selections and try again." />
									-->
								</s:VGroup>	
							</s:Group>
						</mx:Box>
						
					</mx:TabNavigator>
				</s:VGroup>
			</s:VGroup>
		</wimControls:contentGroup>
	</wimControls:CollapsingBox>
	<!-- End Custom data tools -->
	
	
	<s:VGroup top="190" left="5">
		<!-- legend -->
		<wimControls:CollapsingBox id="explanation" 
								   startCollapsed="false"	
								   boxTitle="Explanation">
			<wimControls:contentGroup>
				<s:VGroup>
					<mx:Box id="legendContainer" backgroundColor="0xf4f1dd" width="285" verticalScrollPolicy="{(legendContainer.height == legendContainer.maxHeight) ? 'on' : 'off'}" maxHeight="200">
						<s:VGroup id="legendControls" paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5" gap="0">
							<!-- Begin legends for browse tab results -->
							<localControls:MapServiceLegend id="scenariosLegend" map="{map}" visible="{scenarios.visible &amp;&amp; (scenarios.visibleLayers != null &amp;&amp; scenarios.visibleLayers.length != 0)}" needsUpdates="true" includeInLayout="{scenarios.visible &amp;&amp; (scenarios.visibleLayers != null &amp;&amp; scenarios.visibleLayers.length != 0)}" serviceLayer="{scenarios}" legendWidth="245" />
							<localControls:MapServiceLegend id="scenariosSmallLegend" map="{map}" visible="{scenariosSmall.visible &amp;&amp; (scenariosSmall.visibleLayers != null &amp;&amp; scenariosSmall.visibleLayers.length != 0)}" needsUpdates="true" includeInLayout="{scenariosSmall.visible &amp;&amp; (scenariosSmall.visibleLayers != null &amp;&amp; scenariosSmall.visibleLayers.length != 0)}" serviceLayer="{scenariosSmall}" legendWidth="245" />
							<localControls:MapServiceLegend id="scenariosCatchmentsLegend" map="{map}" visible="{scenariosCatchments.visible &amp;&amp; (scenariosCatchments.visibleLayers != null &amp;&amp; scenariosCatchments.visibleLayers.length != 0)}" needsUpdates="true" includeInLayout="{scenariosCatchments.visible &amp;&amp; (scenariosCatchments.visibleLayers != null &amp;&amp; scenariosCatchments.visibleLayers.length != 0)}" serviceLayer="{scenariosCatchments}" legendWidth="245" />
							<localControls:MapServiceLegend id="scenariosCatchmentsSmallLegend" map="{map}" visible="{scenariosCatchmentsSmall.visible &amp;&amp; (scenariosCatchmentsSmall.visibleLayers != null &amp;&amp; scenariosCatchmentsSmall.visibleLayers.length != 0)}" needsUpdates="true" includeInLayout="{scenariosCatchmentsSmall.visible &amp;&amp; (scenariosCatchmentsSmall.visibleLayers != null &amp;&amp; scenariosCatchmentsSmall.visibleLayers.length != 0)}" serviceLayer="{scenariosCatchmentsSmall}" legendWidth="245" />
							<localControls:MapServiceLegend id="scenariosHUC12Legend" map="{map}" visible="{scenariosHUC12.visible &amp;&amp; (scenariosHUC12.visibleLayers != null &amp;&amp; scenariosHUC12.visibleLayers.length != 0)}" needsUpdates="true" includeInLayout="{scenariosHUC12.visible &amp;&amp; (scenariosHUC12.visibleLayers != null &amp;&amp; scenariosHUC12.visibleLayers.length != 0)}" serviceLayer="{scenariosHUC12}" legendWidth="245" />
							<localControls:MapServiceLegend id="climateStreamflowLegend" map="{map}" visible="{climateStreamflow.visible &amp;&amp; (climateStreamflow.visibleLayers != null &amp;&amp; climateStreamflow.visibleLayers.length != 0)}" needsUpdates="true" includeInLayout="{climateStreamflowLegend.visible}" serviceLayer="{climateStreamflow}" legendWidth="245" />
							<localControls:MapServiceLegend id="climateStreamflowSmallLegend" map="{map}" visible="{climateStreamflowSmall.visible &amp;&amp; (climateStreamflowSmall.visibleLayers != null &amp;&amp; climateStreamflowSmall.visibleLayers.length != 0)}" needsUpdates="true" includeInLayout="{climateStreamflowSmallLegend.visible}" serviceLayer="{climateStreamflowSmall}" legendWidth="245" />
							<!-- End legends for browse tab results -->
							
							<!-- Begin legends for search tab results -->
							<!--<localControls:MapServiceLegend id="searchLegend" map="{map}" visible="{fishVisSearch.visible &amp;&amp; fishVisSearch.visibleLayers.length &gt; 0}" legendTitle="{(fishVisSearch.visibleLayers.getItemAt(0) == 0) ? 'Reaches' : 'Catchments'} that meet search criteria" needsUpdates="true" includeInLayout="{fishVisSearch.visible}" serviceLayer="{fishVisSearch}" legendWidth="245" />
							--><!-- End legends for search tab results -->
							
							<!-- Additional layer legends -->
							<localControls:MapServiceLegend id="fishSampleLocationsLegend" map="{map}" serviceLayer="{fishSampleLocations}" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="streamBufferLegend" map="{map}" serviceLayer="{streamBuffer}" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="nhdStreamsLegend" map="{map}" serviceLayer="{nhdStreams}" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="nhdLakesLegend" map="{map}" serviceLayer="{nhdLakes}" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="catchmentsLegend" map="{map}" serviceLayer="{catchments}" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="huc12Legend" map="{map}" serviceLayer="{huc12s}" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="ecoregionsLegend" map="{map}" serviceLayer="{ecoregions}" legendWidth="245" needsUpdates="false" />
							<!--<mx:Image id="padusLegend" source="./assets/images/PAD_US_explanation.png" visible="{padus.visible}" includeInLayout="{padus.visible}"/>-->
							<localControls:MapServiceLegend id="padusLegend" map="{map}" serviceLayer="{padus}" legendTitle="Public land ownership (PAD-US)" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="padusStatusLegend" map="{map}" serviceLayer="{padusStatus}" legendTitle="Conservation status (PAD-US)" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="landCoverLegend" map="{map}" serviceLayer="{landCover2006}" legendTitle="Land use/land cover (NLCD 2006)" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="disturbanceLegend" map="{map}" serviceLayer="{disturbance}" legendTitle="Disturbance (HUC12 level)" legendFilter="{['Not Scored / Unavailable at this scale','Very Low','Low','Moderate','High','Very High']}" legendWidth="245" needsUpdates="false" />
							<localControls:MapServiceLegend id="lccLegend" map="{map}" serviceLayer="{lcc}" legendTitle="USFWS Landscape Conservation Cooperatives" legendWidth="245" needsUpdates="false" />
						</s:VGroup>
						<!--<s:VScrollBar viewport="{legendControls}" height="{legendControls.height}" width="100%"/>-->
					</mx:Box>
				</s:VGroup>
			</wimControls:contentGroup>
		</wimControls:CollapsingBox>
		<!-- end legend -->
		<!-- available layers -->
		<wimControls:CollapsingBox id="availableLayers" 
								   startCollapsed="false"	
								   boxTitle="Available Layers" >
			<wimControls:contentGroup>
				<s:VGroup>
					<s:VGroup
						width="335">
						<mx:Box id="layersBox" width="100%" verticalScrollPolicy="{(layersBox.height == layersBox.maxHeight) ? 'on' : 'off'}"  maxHeight="{FlexGlobals.topLevelApplication.height-layerToggles.height-300}" minHeight="200">
							<s:Group id="layersForScroll" width="100%" bottom="20">
								<s:Rect width="100%" height="100%"><!--verticalScrollPolicy="{(legendContainer.height == legendContainer.maxHeight) ? 'on' : 'off'}"-->
									<s:fill><s:SolidColor color="black" /></s:fill>
								</s:Rect>
								<s:VGroup id="layerToggles" paddingTop="5" paddingLeft="10" >
									<s:Label text="Additional Layers" />
									<wimControls:LayerToggle id="fishSampleLocationsToggle" layerID="1" serviceLayerID="fishSampleLocations" layerTitle="Fish sampling locations" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="A location on a stream reach associated with an electrofishing survey to determine abundances of fish species." 
															 selected="{fishSampleLocations.visible}" creationComplete="{ fishSampleLocationsToggle.selected=false; }" />
									<wimControls:LayerToggle id="streamBufferToggle" layerID="1" serviceLayerID="streamBuffer" layerTitle="Stream buffer"
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="{streamBufferTooltip}"
															 selected="{streamBuffer.visible}" creationComplete="{ streamBufferToggle.selected=false; }" />
									<wimControls:LayerToggle id="nhdStreamsToggle" layerID="1" serviceLayerID="nhdStreams" layerTitle="Streams"
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="From NHDPlus, which combines the medium-resolution NHD with a digital elevation model with 30-meter grid spacing to produce several derivative datasets that enable the definition of the land surface areas (catchment). NHDPlus Version 1 (NHDPlusV1) was released in 2006."
															 selected="{nhdStreams.visible}" />
									<wimControls:LayerToggle id="nhdLakesToggle" layerID="1" serviceLayerID="nhdLakes" layerTitle="Lakes"
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="From NHDPlus, which combines the medium-resolution NHD with a digital elevation model with 30-meter grid spacing to produce several derivative datasets that enable the definition of the land surface areas (catchment). NHDPlus Version 1 (NHDPlusV1) was released in 2006."
															 selected="{nhdLakes.visible}" />
									<wimControls:LayerToggle id="catchmentsToggle" layerID="1" serviceLayerID="catchments" layerTitle="Catchments" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="From NHDPlus, which combines the medium-resolution NHD with a digital elevation model with 30-meter grid spacing to produce several derivative datasets that enable the definition of the land surface areas (catchment). NHDPlus Version 1 (NHDPlusV1) was released in 2006."
															 selected="{catchments.visible}" creationComplete="{ catchmentsToggle.selected=false; }"/>
									<wimControls:LayerToggle id="huc12Toggle" layerID="1" serviceLayerID="huc12s" layerTitle="Hydrologic units (HUC12)" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="Drainage basins in the United States are divided and sub-divided into successively smaller hydrologic units (HUC), as defined by the USGS Watershed Boundary Dataset. A HUC12 refers to the sixth-level HUC with a 12-digit identification code."
															 selected="{huc12s.visible}" creationComplete="{ huc12Toggle.selected=false; }" />
									<wimControls:LayerToggle id="ecoregionsToggle" layerID="2" serviceLayerID="ecoregions" layerTitle="Ecoregions (EPA Wadable Streams Assessment)" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="US Environmental Protection Agency’s (EPA) Wadeable Streams Assessment (WSA) ecoregions are aggregations of Omernik level III terrestrial ecoregions (Omernik 1987) and are defined as large regions of the landscape with broadly similar landform and climate characteristics (https://www.epa.gov/national-aquatic-resource-surveys/wadeable-streams-assessment)."
															 selected="{ecoregions.visible}" creationComplete="{ ecoregionsToggle.selected=false; }"/>
									<wimControls:LayerToggle id="padusToggle" layerID="0" serviceLayerID="padus" layerTitle="Public land ownership (PAD-US)" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="Created as part of the USGS Gap Analysis Program, the Protected Areas Database of the United States (PAD-US) illustrates and describes public land ownership, management and conservation lands nationally, including voluntarily provided privately protected areas."
															 selected="{padus.visible}" creationComplete="{ padusToggle.selected=false; }"/>
									<wimControls:LayerToggle id="padusStatusToggle" layerID="0" serviceLayerID="padusStatus" layerTitle="Conservation status (PAD-US)" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="These designations are based off the Protected Areas Database of the United States (PAD-US), the official inventory of protected open space in the United States (http://gapanalysis.usgs.gov/padus/)."
															 selected="{padusStatus.visible}" creationComplete="{ padusStatusToggle.selected=false; }"/>
									<wimControls:LayerToggle id="landCoverToggle" layerID="2" serviceLayerID="landCover2006" layerTitle="Land use/land cover (NLCD 2006)" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="Created by the Multi-Resolution Land Characteristics Consortium (MRLC), the National Land Cover Database 2006 is a 16-class land cover classification scheme that has been applied consistently across the conterminous United States at a spatial resolution of 30 meters."
															 selected="{landCover2006.visible}" creationComplete="{ landCoverToggle.selected=false; }" />
									<wimControls:LayerToggle id="disturbanceToggle" layerID="2" serviceLayerID="disturbance" layerTitle="Fish Habitat Condition Index (NFHAP 2010)" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="Created as part of the National Fish Habitat Partnership, the Fish Habitat Condition Index estimates disturbance levels to fish habitats in rivers and estuaries from information about human activities occurring in the watersheds and the local areas affecting each aquatic habitat. Habitats with a very high risk of current habitat degradation include those in or near urban development, livestock grazing, agriculture, point source pollution, or areas with high numbers of active mines and dams. More information in 'An Index of Cumulative Disturbance to River Fish Habitats of the Conterminous United States from Landscape Anthropogenic Activities'.  Click the ? for more information."
															 clickURL="http://muse.jhu.edu/journals/ecological_restoration/v029/29.1.esselman.html"
															 selected="{disturbance.visible}" creationComplete="{ disturbanceToggle.selected=false; }"/>
									<wimControls:LayerToggle id="lccToggle" layerID="2" serviceLayerID="lcc" layerTitle="USFWS Landscape Conservation Cooperatives" 
															 opacBoxBGColor="0x444444" openOpacityRight="true" opacityBoxAlpha="0.9"
															 moreInfoToolTip="Landscape Conservation Cooperatives (LCCs) were created to better integrate science and management to address environmental issues, such as climate change and other landscape scale issues, over large regions that make-up multiple states and territories to insure sustaining natural and cultural resources."
															 clickURL=""
															 selected="{lcc.visible}" creationComplete="{ lccToggle.selected=false; }"/>
								</s:VGroup>
								<!--<s:VScrollBar viewport="{layerToggles}" />-->
							</s:Group>
						</mx:Box>
					</s:VGroup>
				</s:VGroup>
			</wimControls:contentGroup>
		</wimControls:CollapsingBox>
		<!-- End available layers -->
		
	</s:VGroup>
	
	<!-- download button -->
	<s:VGroup gap="0" horizontalAlign="right" top="5" right="395" useHandCursor="true" buttonMode="true" > <!--click="navigateToURL(new URLRequest('https://www.sciencebase.gov/catalog/item/52138cf2e4b0b08f44619be8?community=Northeast+CSC'))">--> 
		<s:BorderContainer
			id="download"
			backgroundColor="0x990033"
			cornerRadius="5"
			height="35"
			borderColor="1"
			right="0"
			click="{downloadInfo.visible = true}">
			<s:HGroup height="100%" paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5" fontWeight="bold" verticalAlign="middle">
				<s:Label text="Download FishTail dataset" fontSize="14" color="white" />
			</s:HGroup>
		</s:BorderContainer>
	</s:VGroup>
	<!-- end download button -->
	
	<!-- fishtail model limitation button -->
	<s:VGroup gap="5" horizontalAlign="right" top="5" right="180" useHandCursor="true" buttonMode="true">
		<s:BorderContainer
			id="modelLimits"
			backgroundColor="0x948A54"
			cornerRadius="5"
			height="35"
			borderColor="1"
			right="0" 
			click="{modelLimitInfo.visible = true}">
			<s:HGroup height="100%" paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5" fontWeight="bold" verticalAlign="middle">
				<s:Label text="FishTail model limitations" fontSize="14" color="white" />
			</s:HGroup>
		</s:BorderContainer>
	</s:VGroup>
	<!-- end fishtail model limitation button -->
	
	<!-- Download Link Box -->
	<s:BorderContainer 
		id="downloadInfo"
		top="45"
		right="395"
		backgroundColor="white" 
		borderColor="black"
		cornerRadius="0"
		width="410"
		visible="false"
		useHandCursor="false">						
		<s:VGroup width="100%" gap="0">
			<mx:HBox backgroundColor="0x990033" textAlign="center" width="100%" paddingTop="5" paddingLeft="5" paddingRight="5">
				<mx:Text width="100%" color="white" fontSize="14" fontWeight="bold" text="Download FishTail dataset" textAlign="left" />
				<mx:Text text="X" click="{downloadInfo.visible = false}" fontWeight="bold" fontSize="12" color="white" textAlign="right" useHandCursor="true" buttonMode="true" mouseChildren="false" toolTip="close"/>
			</mx:HBox>
			<mx:VBox width="100%" backgroundColor="0xCCCCCC">
				<mx:Text width="100%" color="black"
						 textAlign="left" condenseWhite="true" paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5">
					<mx:htmlText>
						<![CDATA[
						<font size='12' color='#000000'>
						<p>Current and future disturbances indices, as well as variables, used to create indices are available for download. Variables include current human landscape disturbances and future climate projections.  Distributions of priority fish species by HUC-12 watersheds will also be available. Spatial data are provided as a file geodatabase with Federal Geographic Data Committee (FGDC) compliant metadata. 
						<font size='12' color='#948A54'><b><a target='_blank' href='https://www.sciencebase.gov/catalog/item/52138cf2e4b0b08f44619be8?community=Northeast+CSC'>Click here</a></b></font> to access the download site.</p>
						]]>
					</mx:htmlText> <!--   -->
				</mx:Text>
			</mx:VBox>
		</s:VGroup>			
	</s:BorderContainer>
	<!--End Download Link Box-->
	
	<!-- FishTail Link Box -->
	<s:BorderContainer 
		id="modelLimitInfo"
		top="45"
		right="180"
		backgroundColor="white" 
		borderColor="black"
		cornerRadius="0"
		width="410"
		visible="false"
		useHandCursor="false">						
		<s:VGroup width="100%" gap="0">
			<mx:HBox backgroundColor="0x948A54" textAlign="center" width="100%" paddingTop="5" paddingLeft="5" paddingRight="5">
				<mx:Text width="100%" color="white" fontSize="14" fontWeight="bold" text="FishTail model limitations" textAlign="left" />
				<mx:Text text="X" click="{modelLimitInfo.visible = false}" fontWeight="bold" fontSize="12" color="white" textAlign="right" useHandCursor="true" buttonMode="true" mouseChildren="false" toolTip="close"/>
			</mx:HBox>
			<mx:VBox width="100%" backgroundColor="0xCCCCCC">
				<mx:Text width="100%" color="black"
							 textAlign="left" condenseWhite="true" paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5">
					<mx:htmlText>
						<![CDATA[
						<font size='12' color='#000000'>
						<p>Indices were created based on results of analyses to detect associations between human landscape disturbances and projected changes in climate with stream fish abundances. Fish species selected for this assessment were identified as priorities by NECSC stakeholders. Assessment results are characterized as “risk of current habitat degradation” for current human disturbance variables and should be interpreted as reflecting the relative degree of threats to aquatic habitats in a particular region. Water quality scores should not be compared across state boundaries due to differences in sampling protocols. Additionally, water quality impairments data were only available as locations with impairments, therefore locations with “Very low” risk scores either were sampled and did not have any impairment or were never sampled. Assessment results for projected changes in climate are characterized as “risk of change” and reflect the relative degree of change in climate in a particular region.</p>
						]]>
					</mx:htmlText> <!--   -->
				</mx:Text>
			</mx:VBox>
		</s:VGroup>			
	</s:BorderContainer>
	<!--End FishTail Link Box-->
	
	<localControls:BaseMapGallery id="baseLayers" top="5" right="60" creationComplete="{baseLayers.selectedLayer = 'Topo';}" />
	
	
	<!-- WiM Logo -->
	
	<!--<mx:Box right="15" bottom="15" paddingLeft="2" paddingRight="5" borderColor="black" borderStyle="solid" backgroundColor="white">
		<mx:Image id="wimLogo" source="{resourceManager.getString('ui.graphics', 'wimLogo')}" useHandCursor="true" buttonMode="true" mouseChildren="false" toolTip="Wisconsin Internet Mapper Group" click="navigateToURL(new URLRequest('http://wi.water.usgs.gov/wim/index.html'))" />
	</mx:Box>-->
    
	<!-- End WiM Logo -->
	
	
	<!-- Shows Map Scale and Lat Long Box -->
    <wimControls:CoordsScale map="{map}" alpha="0.6" bottom="10" width="100%" />
		
	<!-- Loading Screen -->
	<localControls:BasicLoadingScreen id="loadingScreen" color="0xBBBBBB" gifUrl="./assets/images/ajax-loader.gif" useGif="true" visible="false" alpha="0.6" />
		
	<!-- Begin mapper info -->
	
	<s:BorderContainer 
		id="moreInfo" 
		backgroundColor="white" 
		cornerRadius="5"
		visible="false"
		left="300"
		top="61"
		>						
		
		<s:VGroup width="100%">
			
			<mx:HBox backgroundColor="black" textAlign="center" cornerRadius="5" width="100%" paddingTop="5" paddingLeft="5" paddingBottom="5" paddingRight="5">
				<mx:Text width="100%" color="white" fontSize="14" fontWeight="bold" text="Mapper Information" />
				<s:Group left="4">
					<s:Ellipse width="16" height="16" top="2">
						<s:fill><s:SolidColor color="gray" /></s:fill>
					</s:Ellipse>
					<s:Label text="X" color="white" toolTip="Close" fontSize="12" buttonMode="true" height="16" left="4" bottom="1" click="moreInfo.visible = false" verticalAlign="bottom" />	
				</s:Group>	
			</mx:HBox>
			
			<mx:VBox width="600" maxHeight="550" verticalGap="0" paddingTop="5" paddingLeft="10" paddingRight="10">
				
				<mx:Text width="100%" textAlign="left" condenseWhite="true">
					<mx:htmlText>
						<![CDATA[<font size='12' color='#000000'><p>
						<p><b>ABOUT FISHTAIL:  A decision support mapper for conserving stream fish habitats of the Northeast Climate Science Center (NECSC) region</b></p><br/>
						<p><b><i>Assessing current and future condition of fluvial habitats</i></b></p><br/>
						<p>Human landscape disturbances occurring throughout the Northeast U.S. that include urbanization, agriculture, and dams have multiple effects on the region’s streams which support economically and socially valuable stream fishes.  Changes in climate are expected to cause additional changes in stream habitats, including changing water temperatures, which will potentially alter future stream fish assemblages. To manage streams for current human disturbances as well as future changes, managers need region-wide information for decision-making and development of proactive management strategies.  Our project helps to meet that need by integrating results of a current condition assessment of stream habitats based on fish response to human landscape disturbances, water quality impairment, and fragmentation by dams with estimates of which stream habitats may change in their ability to support current fish assemblages with changing climate.  This decision support mapper, FISHTAIL, will allow users to evaluate how fish may respond to current and future condition of fish habitats so managers can better protect and conserve stream fishes.</p><br/>
						<p>Users of FISHTAIL have the capability of viewing a variety of information to support decision making, which can be displayed for different spatial units such as the stream reach or large watersheds; views of information can be tailored to the entire study region, individual states, or ecoregions; and results can reflect response of groups of species or key species of interest to management. Types of information that can be displayed with FISHTAIL include:</p><br/>
						<p><b><i>Current condition of fish habitats</i></b></p><br/>
						<p><ul><li>An index characterizing stream fish response to urban and agricultural land use as characterized by the 2006 National Land Cover Dataset</li>
						<li>An index characterizing stream fish response to river fragmentation by large dams</li>
						<li>An index characterizing stream fish response to water quality impairment as reflected by 303d listings in waterbodies</li>
						<br/>
						<p><b><i>Future condition of fish habitats</i></b></p><br/>
						<p><ul><li>An index characterizing the likelihood of stream habitat to change in ability to support thermally and hydrologically sensitive fish species with projected changes in climate</li>
						<br/>
						<p><b><i>Additional information to support decision making</i></b></p><br/>
						<p><ul><li>Locations of protected lands throughout the NECSC region</li>
						<li>Fish habitat condition scores developed for streams of the conterminous United States in support of the National Fish Habitat Partnership 2015 Assessment</li>
						<br/>
						<br/>
						]]>
					</mx:htmlText>
				</mx:Text>
				<s:HGroup paddingBottom="10">
					<mx:Image source="./assets/images/wim_logo.png" useHandCursor="true" buttonMode="true" mouseChildren="false" toolTip="Wisconsin Internet Mapping" click="navigateToURL(new URLRequest('http://wi.water.usgs.gov/wim/index.html'))" />					
				</s:HGroup>
				</mx:VBox>
		</s:VGroup>			
		
	</s:BorderContainer>
	
	<!-- End mapper info -->
	
</mx:Application>
